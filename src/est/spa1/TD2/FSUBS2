      MODULE NMPRD4P
      USE SIZES, ONLY: DPSIZE
      USE NMPRD4,ONLY: VRBL
      IMPLICIT NONE
      SAVE
      REAL(KIND=DPSIZE), DIMENSION (:),POINTER ::COM
      REAL(KIND=DPSIZE), POINTER ::ET1,ET2,ET3,ET4,ET5,CL,V2,Q,V3,KA
      REAL(KIND=DPSIZE), POINTER ::SC,CVERR,W,Y,A000056,A000057
      REAL(KIND=DPSIZE), POINTER ::A000058,A000059,A000060,A000061
      REAL(KIND=DPSIZE), POINTER ::A000062,A000063,A000064,A000065
      REAL(KIND=DPSIZE), POINTER ::A000066,A000067,D000001,D000002
      REAL(KIND=DPSIZE), POINTER ::D000003,D000004,D000005,D000006
      REAL(KIND=DPSIZE), POINTER ::D000007,D000008,D000009,D000010
      REAL(KIND=DPSIZE), POINTER ::D000011,D000012,D000013,D000014
      REAL(KIND=DPSIZE), POINTER ::D000015,D000016,D000017,D000018
      REAL(KIND=DPSIZE), POINTER ::D000019,D000020,D000055,D000070
      REAL(KIND=DPSIZE), POINTER ::D000069,D000068,D000067,D000066
      REAL(KIND=DPSIZE), POINTER ::D000054,D000065,D000064,D000063
      REAL(KIND=DPSIZE), POINTER ::D000062,D000053,D000061,D000060
      REAL(KIND=DPSIZE), POINTER ::D000059,D000052,D000058,D000057
      REAL(KIND=DPSIZE), POINTER ::D000051,D000056,D000076,D000101
      REAL(KIND=DPSIZE), POINTER ::D000102,D000103,D000104,D000105
      REAL(KIND=DPSIZE), POINTER ::D000077,D000110,D000111,D000112
      REAL(KIND=DPSIZE), POINTER ::D000113,D000078,D000117,D000118
      REAL(KIND=DPSIZE), POINTER ::D000119,D000079,D000122,D000123
      REAL(KIND=DPSIZE), POINTER ::D000080,D000125,C000031,D000126
      REAL(KIND=DPSIZE), POINTER ::D000127,D000128,D000129,D000130
      CONTAINS
      SUBROUTINE ASSOCNMPRD4
      COM=>VRBL
      ET1=>COM(000001);ET2=>COM(000002);ET3=>COM(000003)
      ET4=>COM(000004);ET5=>COM(000005);CL=>COM(000006)
      V2=>COM(000007);Q=>COM(000008);V3=>COM(000009);KA=>COM(000010)
      SC=>COM(000011);CVERR=>COM(000012);W=>COM(000013);Y=>COM(000014)
      A000056=>COM(000015);A000057=>COM(000016);A000058=>COM(000017)
      A000059=>COM(000018);A000060=>COM(000019);A000061=>COM(000020)
      A000062=>COM(000021);A000063=>COM(000022);A000064=>COM(000023)
      A000065=>COM(000024);A000066=>COM(000025);A000067=>COM(000026)
      D000001=>COM(000027);D000002=>COM(000028);D000003=>COM(000029)
      D000004=>COM(000030);D000005=>COM(000031);D000006=>COM(000032)
      D000007=>COM(000033);D000008=>COM(000034);D000009=>COM(000035)
      D000010=>COM(000036);D000011=>COM(000037);D000012=>COM(000038)
      D000013=>COM(000039);D000014=>COM(000040);D000015=>COM(000041)
      D000016=>COM(000042);D000017=>COM(000043);D000018=>COM(000044)
      D000019=>COM(000045);D000020=>COM(000046);D000055=>COM(000047)
      D000070=>COM(000048);D000069=>COM(000049);D000068=>COM(000050)
      D000067=>COM(000051);D000066=>COM(000052);D000054=>COM(000053)
      D000065=>COM(000054);D000064=>COM(000055);D000063=>COM(000056)
      D000062=>COM(000057);D000053=>COM(000058);D000061=>COM(000059)
      D000060=>COM(000060);D000059=>COM(000061);D000052=>COM(000062)
      D000058=>COM(000063);D000057=>COM(000064);D000051=>COM(000065)
      D000056=>COM(000066);D000076=>COM(000067);D000101=>COM(000068)
      D000102=>COM(000069);D000103=>COM(000070);D000104=>COM(000071)
      D000105=>COM(000072);D000077=>COM(000073);D000110=>COM(000074)
      D000111=>COM(000075);D000112=>COM(000076);D000113=>COM(000077)
      D000078=>COM(000078);D000117=>COM(000079);D000118=>COM(000080)
      D000119=>COM(000081);D000079=>COM(000082);D000122=>COM(000083)
      D000123=>COM(000084);D000080=>COM(000085);D000125=>COM(000086)
      C000031=>COM(000087);D000126=>COM(000088);D000127=>COM(000089)
      D000128=>COM(000090);D000129=>COM(000091);D000130=>COM(000092)
      END SUBROUTINE ASSOCNMPRD4
      END MODULE NMPRD4P
      SUBROUTINE PK(ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,IRGG,GG,NETAS)      
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMBAYES_REAL,    ONLY: PRIOR_INFO
      USE NMBAYES_REAL, ONLY: ADDL_ACTUAL,ADDL_TIMEDIFF,ADDL_TIME
      USE NMPRD_INT, ONLY: PRED_IGNORE_DATA,PRED_IGNORE_DATA_TEST
      USE PRCOM_INT, ONLY: DES_DER=>MITER
      USE NMPRD_REAL,ONLY: ETA,EPS                                            
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,COMACT,COMSAV,IFIRSTEM,FIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE NMPRD_INT, ONLY: IQUIT
      USE PROCM_INT, ONLY: NEWIND=>PNEWIF                                       
      USE NMBAYES_REAL, ONLY: LDF                                             
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                          
      REAL(KIND=DPSIZE) :: EVTREC                                               
      SAVE
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS,IRGG,NETAS              
      DIMENSION :: IDEF(7,*),THETA(*),EVTREC(IREV,*),INDXS(*),GG(IRGG,GPKD+1,*) 
      FIRSTEM=IFIRSTEM
      IF (ICALL <= 1) THEN                                                      
      CALL ASSOCNMPRD4
      IDEF(   1,0001)=  -9
      IDEF(   1,0002)=  -1
      IDEF(   1,0003)=   0
      IDEF(   1,0004)=   0
      IDEF(   2,0003)=   0
      IDEF(   2,0004)=   0
      IDEF(   3,0002)=   6
      CALL GETETA(ETA)                                                          
      IF (IQUIT == 1) RETURN                                                    
      RETURN                                                                    
      ENDIF                                                                     
      IF (NEWIND /= 2) THEN
      IF (ICALL == 4) THEN
      CALL SIMETA(ETA)
      ELSE
      CALL GETETA(ETA)
      ENDIF
      IF (IQUIT == 1) RETURN
      ENDIF
 !  level            0
      B000001=ETA(001)*THETA(006) 
      B000002=DEXP(B000001) 
      ET1=B000002 
      B000003=ETA(002)*THETA(007) 
      B000004=DEXP(B000003) 
      ET2=B000004 
      B000005=ETA(003)*THETA(008) 
      B000006=DEXP(B000005) 
      ET3=B000006 
      B000007=ETA(004)*THETA(009) 
      B000008=DEXP(B000007) 
      ET4=B000008 
      B000009=ETA(005)*THETA(010) 
      B000010=DEXP(B000009) 
      ET5=B000010 
      CL=5.0D0*THETA(001)*ET1 
      V2=35.D0*THETA(002)*ET2 
      Q=50.D0*THETA(003)*ET3 
      V3=50.D0*THETA(004)*ET4 
      KA=0.7D0*THETA(005)*ET5 
      SC=V2 
      IF (FIRSTEM == 1) THEN
!                      A000032 = DERIVATIVE OF B000002 W.R.T. ETA(001)
      A000032=B000002*THETA(006) 
!                      A000037 = DERIVATIVE OF B000004 W.R.T. ETA(002)
      A000037=B000004*THETA(007) 
!                      A000042 = DERIVATIVE OF B000006 W.R.T. ETA(003)
      A000042=B000006*THETA(008) 
!                      A000047 = DERIVATIVE OF B000008 W.R.T. ETA(004)
      A000047=B000008*THETA(009) 
!                      A000052 = DERIVATIVE OF B000010 W.R.T. ETA(005)
      A000052=B000010*THETA(010) 
      B000011=5.0D0*THETA(001) 
!                      A000056 = DERIVATIVE OF CL W.R.T. ETA(001)
      A000056=B000011*A000032 
      B000012=35.D0*THETA(002) 
!                      A000058 = DERIVATIVE OF V2 W.R.T. ETA(002)
      A000058=B000012*A000037 
      B000013=50.D0*THETA(003) 
!                      A000060 = DERIVATIVE OF Q W.R.T. ETA(003)
      A000060=B000013*A000042 
      B000014=50.D0*THETA(004) 
!                      A000062 = DERIVATIVE OF V3 W.R.T. ETA(004)
      A000062=B000014*A000047 
      B000015=0.7D0*THETA(005) 
!                      A000064 = DERIVATIVE OF KA W.R.T. ETA(005)
      A000064=B000015*A000052 
!                      A000066 = DERIVATIVE OF SC W.R.T. ETA(002)
      A000066=A000058 
      GG(0001,1,1)=CL
      GG(0001,0002,1)=A000056
      GG(0002,1,1)=V2
      GG(0002,0003,1)=A000058
      GG(0003,1,1)=Q
      GG(0003,0004,1)=A000060
      GG(0004,1,1)=V3
      GG(0004,0005,1)=A000062
      GG(0005,1,1)=KA
      GG(0005,0006,1)=A000064
      GG(0006,1,1)=SC
      GG(0006,0003,1)=A000066
      ELSE
      GG(0001,1,1)=CL
      GG(0002,1,1)=V2
      GG(0003,1,1)=Q
      GG(0004,1,1)=V3
      GG(0005,1,1)=KA
      GG(0006,1,1)=SC
      ENDIF
      IF (MSEC == 1) THEN
!                      A000034 = DERIVATIVE OF A000032 W.R.T. ETA(001)
      A000034=THETA(006)*A000032 
!                      A000039 = DERIVATIVE OF A000037 W.R.T. ETA(002)
      A000039=THETA(007)*A000037 
!                      A000044 = DERIVATIVE OF A000042 W.R.T. ETA(003)
      A000044=THETA(008)*A000042 
!                      A000049 = DERIVATIVE OF A000047 W.R.T. ETA(004)
      A000049=THETA(009)*A000047 
!                      A000054 = DERIVATIVE OF A000052 W.R.T. ETA(005)
      A000054=THETA(010)*A000052 
!                      A000057 = DERIVATIVE OF A000056 W.R.T. ETA(001)
      A000057=B000011*A000034 
!                      A000059 = DERIVATIVE OF A000058 W.R.T. ETA(002)
      A000059=B000012*A000039 
!                      A000061 = DERIVATIVE OF A000060 W.R.T. ETA(003)
      A000061=B000013*A000044 
!                      A000063 = DERIVATIVE OF A000062 W.R.T. ETA(004)
      A000063=B000014*A000049 
!                      A000065 = DERIVATIVE OF A000064 W.R.T. ETA(005)
      A000065=B000015*A000054 
!                      A000067 = DERIVATIVE OF A000066 W.R.T. ETA(002)
      A000067=A000059 
      GG(0001,0002,0002)=A000057
      GG(0002,0003,0003)=A000059
      GG(0003,0004,0004)=A000061
      GG(0004,0005,0005)=A000063
      GG(0005,0006,0006)=A000065
      GG(0006,0003,0003)=A000067
      ENDIF
      RETURN
      END
      SUBROUTINE ERROR (ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,F,G,HH)       
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMPRD_INT, ONLY: PRED_IGNORE_DATA,PRED_IGNORE_DATA_TEST
      USE NMPRD_REAL,ONLY: ETA,EPS                                            
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,IQUIT,IFIRSTEM,FIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE NMBAYES_REAL, ONLY: ADDL_ACTUAL,ADDL_TIMEDIFF,ADDL_TIME
      USE NMPRD_INT, ONLY: NEWL2
      USE PROCM_INT, ONLY: NEWIND=>PNEWIF                                       
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                        
      REAL(KIND=DPSIZE) :: EVTREC                                             
      SAVE
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS                       
      DIMENSION :: IDEF(*),THETA(*),EVTREC(IREV,*),INDXS(*)                   
      REAL(KIND=DPSIZE) :: G(GERD,*),HH(HERD,*)                               
      FIRSTEM=IFIRSTEM
      IF (ICALL <= 1) THEN                                                    
      CALL ASSOCNMPRD4
      IDEF(2)=-1
      IDEF(3)=000
      RETURN
      ENDIF
      IF (ICALL == 4) THEN
      IF (NEWL2 == 1) THEN
      CALL SIMEPS(EPS)
      IF (IQUIT == 1) RETURN
      ENDIF
      ENDIF
      D000001=G(001,1)
      D000002=G(002,1)
      D000003=G(003,1)
      D000004=G(004,1)
      D000005=G(005,1)
 !  level            0
      CVERR=0.05D0 
      W=THETA(011)*F*CVERR 
      Y=F+W*EPS(001) 
!                      C000031 = DERIVATIVE OF Y W.R.T. EPS(001)
      C000031=W 
      IF (FIRSTEM == 1) THEN !1
      B000001=THETA(011)*CVERR 
!                      D000051 = DERIVATIVE OF W W.R.T. ETA(005)
      D000051=B000001*D000005 
!                      D000052 = DERIVATIVE OF W W.R.T. ETA(004)
      D000052=B000001*D000004 
!                      D000053 = DERIVATIVE OF W W.R.T. ETA(003)
      D000053=B000001*D000003 
!                      D000054 = DERIVATIVE OF W W.R.T. ETA(002)
      D000054=B000001*D000002 
!                      D000055 = DERIVATIVE OF W W.R.T. ETA(001)
      D000055=B000001*D000001 
!                      D000071 = DERIVATIVE OF Y W.R.T. ETA(005)
      D000071=D000005 
!                      D000072 = DERIVATIVE OF Y W.R.T. ETA(004)
      D000072=D000004 
!                      D000073 = DERIVATIVE OF Y W.R.T. ETA(003)
      D000073=D000003 
!                      D000074 = DERIVATIVE OF Y W.R.T. ETA(002)
      D000074=D000002 
!                      D000075 = DERIVATIVE OF Y W.R.T. ETA(001)
      D000075=D000001 
!                      D000076 = DERIVATIVE OF Y W.R.T. ETA(001)
      D000076=EPS(001)*D000055+D000075 
!                      D000077 = DERIVATIVE OF Y W.R.T. ETA(002)
      D000077=EPS(001)*D000054+D000074 
!                      D000078 = DERIVATIVE OF Y W.R.T. ETA(003)
      D000078=EPS(001)*D000053+D000073 
!                      D000079 = DERIVATIVE OF Y W.R.T. ETA(004)
      D000079=EPS(001)*D000052+D000072 
!                      D000080 = DERIVATIVE OF Y W.R.T. ETA(005)
      D000080=EPS(001)*D000051+D000071 
!                      D000126 = DERIVATIVE OF C000031 W.R.T. ETA(001)
      D000126=D000055 
!                      D000127 = DERIVATIVE OF C000031 W.R.T. ETA(002)
      D000127=D000054 
!                      D000128 = DERIVATIVE OF C000031 W.R.T. ETA(003)
      D000128=D000053 
!                      D000129 = DERIVATIVE OF C000031 W.R.T. ETA(004)
      D000129=D000052 
!                      D000130 = DERIVATIVE OF C000031 W.R.T. ETA(005)
      D000130=D000051 
      G(001,1)=D000076
      G(002,1)=D000077
      G(003,1)=D000078
      G(004,1)=D000079
      G(005,1)=D000080
      ENDIF !1
      HH(001,1)=C000031
      IF (FIRSTEM == 1) THEN !2
      HH(001,002)=D000126
      HH(001,003)=D000127
      HH(001,004)=D000128
      HH(001,005)=D000129
      HH(001,006)=D000130
      ENDIF !2
      IF (MSEC == 1) THEN
      D000006=G(001,002)
      D000007=G(002,002)
      D000008=G(002,003)
      D000009=G(003,002)
      D000010=G(003,003)
      D000011=G(003,004)
      D000012=G(004,002)
      D000013=G(004,003)
      D000014=G(004,004)
      D000015=G(004,005)
      D000016=G(005,002)
      D000017=G(005,003)
      D000018=G(005,004)
      D000019=G(005,005)
      D000020=G(005,006)
!                      D000056 = DERIVATIVE OF D000051 W.R.T. ETA(005)
      D000056=B000001*D000020 
!                      D000057 = DERIVATIVE OF D000052 W.R.T. ETA(005)
      D000057=B000001*D000019 
!                      D000058 = DERIVATIVE OF D000052 W.R.T. ETA(004)
      D000058=B000001*D000015 
!                      D000059 = DERIVATIVE OF D000053 W.R.T. ETA(005)
      D000059=B000001*D000018 
!                      D000060 = DERIVATIVE OF D000053 W.R.T. ETA(004)
      D000060=B000001*D000014 
!                      D000061 = DERIVATIVE OF D000053 W.R.T. ETA(003)
      D000061=B000001*D000011 
!                      D000062 = DERIVATIVE OF D000054 W.R.T. ETA(005)
      D000062=B000001*D000017 
!                      D000063 = DERIVATIVE OF D000054 W.R.T. ETA(004)
      D000063=B000001*D000013 
!                      D000064 = DERIVATIVE OF D000054 W.R.T. ETA(003)
      D000064=B000001*D000010 
!                      D000065 = DERIVATIVE OF D000054 W.R.T. ETA(002)
      D000065=B000001*D000008 
!                      D000066 = DERIVATIVE OF D000055 W.R.T. ETA(005)
      D000066=B000001*D000016 
!                      D000067 = DERIVATIVE OF D000055 W.R.T. ETA(004)
      D000067=B000001*D000012 
!                      D000068 = DERIVATIVE OF D000055 W.R.T. ETA(003)
      D000068=B000001*D000009 
!                      D000069 = DERIVATIVE OF D000055 W.R.T. ETA(002)
      D000069=B000001*D000007 
!                      D000070 = DERIVATIVE OF D000055 W.R.T. ETA(001)
      D000070=B000001*D000006 
!                      D000081 = DERIVATIVE OF D000071 W.R.T. ETA(005)
      D000081=D000020 
!                      D000082 = DERIVATIVE OF D000072 W.R.T. ETA(005)
      D000082=D000019 
!                      D000083 = DERIVATIVE OF D000072 W.R.T. ETA(004)
      D000083=D000015 
!                      D000084 = DERIVATIVE OF D000073 W.R.T. ETA(005)
      D000084=D000018 
!                      D000085 = DERIVATIVE OF D000073 W.R.T. ETA(004)
      D000085=D000014 
!                      D000086 = DERIVATIVE OF D000073 W.R.T. ETA(003)
      D000086=D000011 
!                      D000087 = DERIVATIVE OF D000074 W.R.T. ETA(005)
      D000087=D000017 
!                      D000088 = DERIVATIVE OF D000074 W.R.T. ETA(004)
      D000088=D000013 
!                      D000089 = DERIVATIVE OF D000074 W.R.T. ETA(003)
      D000089=D000010 
!                      D000090 = DERIVATIVE OF D000074 W.R.T. ETA(002)
      D000090=D000008 
!                      D000091 = DERIVATIVE OF D000075 W.R.T. ETA(005)
      D000091=D000016 
!                      D000092 = DERIVATIVE OF D000075 W.R.T. ETA(004)
      D000092=D000012 
!                      D000093 = DERIVATIVE OF D000075 W.R.T. ETA(003)
      D000093=D000009 
!                      D000094 = DERIVATIVE OF D000075 W.R.T. ETA(002)
      D000094=D000007 
!                      D000095 = DERIVATIVE OF D000075 W.R.T. ETA(001)
      D000095=D000006 
!                      D000096 = DERIVATIVE OF D000076 W.R.T. ETA(001)
      D000096=EPS(001)*D000070 
!                      D000097 = DERIVATIVE OF D000076 W.R.T. ETA(002)
      D000097=EPS(001)*D000069 
!                      D000098 = DERIVATIVE OF D000076 W.R.T. ETA(003)
      D000098=EPS(001)*D000068 
!                      D000099 = DERIVATIVE OF D000076 W.R.T. ETA(004)
      D000099=EPS(001)*D000067 
!                      D000100 = DERIVATIVE OF D000076 W.R.T. ETA(005)
      D000100=EPS(001)*D000066 
!                      D000101 = DERIVATIVE OF D000076 W.R.T. ETA(001)
      D000101=D000095+D000096 
!                      D000102 = DERIVATIVE OF D000076 W.R.T. ETA(002)
      D000102=D000094+D000097 
!                      D000103 = DERIVATIVE OF D000076 W.R.T. ETA(003)
      D000103=D000093+D000098 
!                      D000104 = DERIVATIVE OF D000076 W.R.T. ETA(004)
      D000104=D000092+D000099 
!                      D000105 = DERIVATIVE OF D000076 W.R.T. ETA(005)
      D000105=D000091+D000100 
!                      D000106 = DERIVATIVE OF D000077 W.R.T. ETA(002)
      D000106=EPS(001)*D000065 
!                      D000107 = DERIVATIVE OF D000077 W.R.T. ETA(003)
      D000107=EPS(001)*D000064 
!                      D000108 = DERIVATIVE OF D000077 W.R.T. ETA(004)
      D000108=EPS(001)*D000063 
!                      D000109 = DERIVATIVE OF D000077 W.R.T. ETA(005)
      D000109=EPS(001)*D000062 
!                      D000110 = DERIVATIVE OF D000077 W.R.T. ETA(002)
      D000110=D000090+D000106 
!                      D000111 = DERIVATIVE OF D000077 W.R.T. ETA(003)
      D000111=D000089+D000107 
!                      D000112 = DERIVATIVE OF D000077 W.R.T. ETA(004)
      D000112=D000088+D000108 
!                      D000113 = DERIVATIVE OF D000077 W.R.T. ETA(005)
      D000113=D000087+D000109 
!                      D000114 = DERIVATIVE OF D000078 W.R.T. ETA(003)
      D000114=EPS(001)*D000061 
!                      D000115 = DERIVATIVE OF D000078 W.R.T. ETA(004)
      D000115=EPS(001)*D000060 
!                      D000116 = DERIVATIVE OF D000078 W.R.T. ETA(005)
      D000116=EPS(001)*D000059 
!                      D000117 = DERIVATIVE OF D000078 W.R.T. ETA(003)
      D000117=D000086+D000114 
!                      D000118 = DERIVATIVE OF D000078 W.R.T. ETA(004)
      D000118=D000085+D000115 
!                      D000119 = DERIVATIVE OF D000078 W.R.T. ETA(005)
      D000119=D000084+D000116 
!                      D000120 = DERIVATIVE OF D000079 W.R.T. ETA(004)
      D000120=EPS(001)*D000058 
!                      D000121 = DERIVATIVE OF D000079 W.R.T. ETA(005)
      D000121=EPS(001)*D000057 
!                      D000122 = DERIVATIVE OF D000079 W.R.T. ETA(004)
      D000122=D000083+D000120 
!                      D000123 = DERIVATIVE OF D000079 W.R.T. ETA(005)
      D000123=D000082+D000121 
!                      D000124 = DERIVATIVE OF D000080 W.R.T. ETA(005)
      D000124=EPS(001)*D000056 
!                      D000125 = DERIVATIVE OF D000080 W.R.T. ETA(005)
      D000125=D000081+D000124 
      G(001,002)=D000101
      G(002,002)=D000102
      G(002,003)=D000110
      G(003,002)=D000103
      G(003,003)=D000111
      G(003,004)=D000117
      G(004,002)=D000104
      G(004,003)=D000112
      G(004,004)=D000118
      G(004,005)=D000122
      G(005,002)=D000105
      G(005,003)=D000113
      G(005,004)=D000119
      G(005,005)=D000123
      G(005,006)=D000125
      ENDIF
      F=Y
      RETURN
      END
      SUBROUTINE FSIZESR(NAME_FSIZES,F_SIZES)
      USE SIZES, ONLY: ISIZE
      INTEGER(KIND=ISIZE), DIMENSION(*) :: F_SIZES
      CHARACTER(LEN=*),    DIMENSION(*) :: NAME_FSIZES
      NAME_FSIZES(01)='LTH'; F_SIZES(01)=11
      NAME_FSIZES(02)='LVR'; F_SIZES(02)=6
      NAME_FSIZES(03)='LVR2'; F_SIZES(03)=0
      NAME_FSIZES(04)='LPAR'; F_SIZES(04)=27
      NAME_FSIZES(05)='LPAR3'; F_SIZES(05)=0
      NAME_FSIZES(06)='NO'; F_SIZES(06)=0
      NAME_FSIZES(07)='MMX'; F_SIZES(07)=1
      NAME_FSIZES(08)='LNP4'; F_SIZES(08)=0
      NAME_FSIZES(09)='LSUPP'; F_SIZES(09)=1
      NAME_FSIZES(10)='LIM7'; F_SIZES(10)=0
      NAME_FSIZES(11)='LWS3'; F_SIZES(11)=0
      NAME_FSIZES(12)='MAXIDS'; F_SIZES(12)=100
      NAME_FSIZES(13)='LIM1'; F_SIZES(13)=0
      NAME_FSIZES(14)='LIM2'; F_SIZES(14)=0
      NAME_FSIZES(15)='LIM3'; F_SIZES(15)=0
      NAME_FSIZES(16)='LIM4'; F_SIZES(16)=0
      NAME_FSIZES(17)='LIM5'; F_SIZES(17)=0
      NAME_FSIZES(18)='LIM6'; F_SIZES(18)=0
      NAME_FSIZES(19)='LIM8'; F_SIZES(19)=0
      NAME_FSIZES(20)='LIM10'; F_SIZES(20)=0
      NAME_FSIZES(21)='LIM11'; F_SIZES(21)=0
      NAME_FSIZES(22)='LIM13'; F_SIZES(22)=0
      NAME_FSIZES(23)='LIM15'; F_SIZES(23)=0
      NAME_FSIZES(24)='LIM16'; F_SIZES(24)=0
      NAME_FSIZES(25)='MAXRECID'; F_SIZES(25)=200
      NAME_FSIZES(26)='PC'; F_SIZES(26)=30
      NAME_FSIZES(27)='PCT'; F_SIZES(27)=30
      NAME_FSIZES(28)='PIR'; F_SIZES(28)=700
      NAME_FSIZES(29)='PD'; F_SIZES(29)=50
      NAME_FSIZES(30)='PAL'; F_SIZES(30)=50
      NAME_FSIZES(31)='MAXFCN'; F_SIZES(31)=1000000
      NAME_FSIZES(32)='MAXIC'; F_SIZES(32)=90
      NAME_FSIZES(33)='PG'; F_SIZES(33)=80
      NAME_FSIZES(34)='NPOPMIXMAX'; F_SIZES(34)=0
      NAME_FSIZES(35)='MAXOMEG'; F_SIZES(35)=5
      NAME_FSIZES(36)='MAXPTHETA'; F_SIZES(36)=12
      NAME_FSIZES(37)='MAXITER'; F_SIZES(37)=20
      NAME_FSIZES(38)='ISAMPLEMAX'; F_SIZES(38)=0
      NAME_FSIZES(39)='DIMTMP'; F_SIZES(39)=0
      NAME_FSIZES(40)='DIMCNS'; F_SIZES(40)=0
      NAME_FSIZES(41)='DIMNEW'; F_SIZES(41)=0
      NAME_FSIZES(42)='PDT'; F_SIZES(42)=1
      NAME_FSIZES(43)='LADD_MAX'; F_SIZES(43)=0
      NAME_FSIZES(44)='MAXSIDL'; F_SIZES(44)=0
      NAME_FSIZES(45)='NTT'; F_SIZES(45)=11
      NAME_FSIZES(46)='NOMEG'; F_SIZES(46)=5
      NAME_FSIZES(47)='NSIGM'; F_SIZES(47)=1
      NAME_FSIZES(48)='PPDT'; F_SIZES(48)=1
      NAME_FSIZES(49)='PAST_SIZE'; F_SIZES(49)=4000
      NAME_FSIZES(50)='MAXNRDS'; F_SIZES(50)=30
      RETURN
      END SUBROUTINE FSIZESR
      SUBROUTINE MUMODEL2(THETA,MU_,ICALL,IDEF,NEWIND,&
      EVTREC,DATREC,IREV,NVNT,INDXS,F,G,H,IRGG,GG,NETAS)
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMBAYES_REAL,    ONLY: PRIOR_INFO
      USE NMBAYES_REAL, ONLY: ADDL_ACTUAL,ADDL_TIMEDIFF,ADDL_TIME
      USE NMPRD_INT, ONLY: PRED_IGNORE_DATA,PRED_IGNORE_DATA_TEST
      USE PRCOM_INT, ONLY: DES_DER=>MITER
      USE NMPRD_REAL,ONLY: ETA,EPS
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,COMACT,COMSAV,IFIRSTEM,FIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE NMPRD_INT, ONLY: IQUIT
      USE NMBAYES_REAL, ONLY: LDF
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)
      REAL(KIND=DPSIZE)   :: MU_(*)
      INTEGER NEWIND
      REAL(KIND=DPSIZE) :: EVTREC
      SAVE
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS,IRGG,NETAS
      DIMENSION :: IDEF(7,*),THETA(*),EVTREC(IREV,*),INDXS(*),GG(IRGG,GPKD+1,*)
      RETURN
      END
